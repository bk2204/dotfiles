#!/bin/bash

PATH="$(echo $PATH | sed -e "s,$HOME/bin:,,")"

[ -f "$HOME/.gnupg/redirect" ] || exec gpg "$@"

redirect () {
	# Deal with inaccessible /dev/fd.
	if [ -d '/dev/fd' ]
	then
		exec "$@" 2> \
			>(grep -vE '(gpg: (WARNING: unsafe ownership|using.*as default secret key)|le propriétaire du fichier|n.est pas sûr)' 1>&2)
	else
		exec "$@"
	fi
}


if which gpg2 >/dev/null 2>&1
then
	redirect gpg2 "$@"
else
	redirect gpg "$@"
fi
