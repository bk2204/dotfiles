This PR contains independent, logical, bisectable commits each with their own commit message, and as such is best reviewed commit by commit.
